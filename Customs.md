让 Chunithm 识别并将自制谱添加到选曲界面是一个不直观的过程，因此这里将解释如何正确添加自制内容的基础知识。

# 设置文件格式

由于游戏的性质，Chunithm对它所期望的文件种类和这些文件的规格要求非常明确。如果这些规格不正确，Chunithm 就会直接拒绝在选曲界面上显示歌曲，而不会说明明确的原因。你可以在 [[基本信息](General.md)](General.md#文件类型) 页面上找到 Chunithm 希望看到的文件类型的快速概览。

## 图像

您可能要处理的两种图像文件是 "封面 "和 "版权"。封面文件是歌曲的 "cover art"，可在选曲界面、游戏过程中、结果界面和其他地方看到。版权文件是选择相关歌曲时出现在屏幕左下方的版权信息。 有关这些文件格式的信息，请参见 [基本信息](General.md#文件类型) 页面。

## 音频

音频是最难处理的文件。它采用 CRIWARE 称为 ADX2 的专有音频格式编码，因此很难复制。幸运的是，有一些工具可以解码和编码这些文件。本节将主要介绍如何将自定义文件编码为这种格式。有关这些文件格式的信息，请参见 [基本信息](General.md#音频文件)页面。

### 必要程序

* [SonicAudioTools](https://github.com/blueskythlikesclouds/SonicAudioTools)
* [VGAudio](https://github.com/Thealexbarney/VGAudio)
* [HXD](https://mh-nexus.de/en/hxd/)
* [Audacity](https://www.audacityteam.org/) （可选项，用于调整音量、裁剪、查找预览位置以及将音频文件转换为`.wav`文件。）

### 提取

为了制作自制的 ADX2 乐曲，我们首先要解压缩已有的歌曲。建议备份提取的文件，因为在此方法中你将替换这些文件，之后你需要再次替换文件以防止游戏中的歌曲被覆盖。首先，导航至 ``root\app\data\AXXX\cueFile`` 并选择任意 ``cueFileXXXXXX`` 文件夹。在另一个文件资源管理器窗口中，打开 SonicAudioTools 文件夹。将 cueFile 文件夹中的 ``.acb`` 文件拖入 ``AcbEditor.exe``。cueFile 文件夹中将创建一个新文件夹。在这个文件夹中，将有一个 ``.hca`` 文件。我们暂时不必对该 ``.hca`` 文件做任何处理，而是将其覆盖。

### 准备文件

首先，你要获取想要的音频文件，并将其放入 Audacity 或你选择的音频编辑器中。你现在要做的两件事是调整音量，使其平均电平为 -16dB。这可以在 Audacity 的 "分析" 下的 "对比度" 选项中看到。接下来，你要将歌曲裁剪到所需的长度。Chunithm 中的乐曲通常在 2 到 3 分钟之间，您需要将歌曲裁剪到这个范围左右。如果歌曲长度超过 3 分钟，您可能需要删除歌曲中间的一些部分，如第二节和副歌，从而缩短歌曲长度。确保听起来自然！然后，将文件导出为 16 位 .wav 文件。

### 编码

打开 VGAudio，找到刚才导出的 ``.wav`` 文件。使用该程序将其转换为 ``.hca``。它的标签可能只是 "HCA" 或 "CRI HCA"。将新的 ``.hca`` 文件放到提取第一个 ``.hca`` 文件的文件夹中，然后用相同的名称覆盖现有文件。拖动包含 ``.hca`` 文件的父文件夹并将其放到 ``AcbEditor.exe`` 上。如果一切操作正确，您将用自己的自定义文件覆盖``.acb``和``.awb``文件。

### 最后润色（Final Touches）

用自制谱的 ID 重命名新的 ``.acb`` 和 ``.awb`` 文件。如果尚未创建自定义 Music.xml 文件，只需创建自己的唯一 ID。最后，在 HxD 中打开 ``.acb`` 文件。使用 ``CTRL + F`` 搜索 "music"。查找包含原始 ``.acb`` 文件中先前 ID 的字段，并用新 ID 将其替换。保存 ``.acb`` 文件，并将文件对放在安全的地方。这将在以后的步骤中使用。

# 将所有内容整合在一起

本节将重点介绍您需要创建和编辑的文件和目录。

## 新文件夹

### 添加 CueFile

在 ``root\app\data\AXXX\cueFile`` 目录中，创建一个新文件夹并命名为 ``cueFile00XXXX`` ，将 ``XXXX`` 替换为自定义 ``.acb`` 和 ``.awb`` 文件的 ID。将自定义的 ``.acb`` 和 ``.awb`` 文件拖放到此文件夹中。创建一个新文件并将其命名为 ``CueFile.xml``。将另一个文件夹中 ``CueFile.xml`` 文件的内容复制并粘贴到这个新文件中。将 ``<dataName>``、``<name><id>``、``<name><str>``、``<acbFile><path>`` 和 ``<awbFile><path>`` 标记值替换为适当的值，通常是将 ID 替换为正确的 ID。

### 添加音乐

在 ``root¥app¥data¥AXXX¥music`` 目录中创建一个新文件夹并命名为 ``musicXXXX``，将 ``XXXX`` 替换为自定义 ID。在此创建一个名为``Music.xml``的新文件，然后将现有``Music.xml``文件的内容复制并粘贴到该文件中。按照 [Music](Music.md) 文档中解释的规范配置此文件。您还需要该目录中的 ``.c2s`` 文件。如果您只想让歌曲出现在选曲界面上，可以将现有的 ``.c2s`` 文件复制并粘贴到此目录中，无需进行任何编辑。

### 添加版权信息（可选）

除非你想添加自己的自定义 RightsInfo 图像，否则本部分是可选的。在 ``root\app\data\AXXX\rightsInfo`` 目录中，创建一个新文件夹并命名为 ``rightsInfoXXXXXX`` ，将 ``XXXXXX`` 替换为一个唯一的 ID，该 ID 可以与自定义歌曲的 ID 分开。将自定义版权文件移入此文件夹，并命名为 ``CHU_UI_Rights_XXXX.dds``。创建一个名为 ``RightsInfo.xml`` 的文件，并将现有 ``RightsInfo.xml`` 文件的内容复制并粘贴到新文件中。将 ``<rightsText>`` 替换为版权图像内容的概述，将 ``<name><id>`` 替换为与父文件夹相同的 ID（不包括前面的 0），将 ``<name><str>`` 替换为自定义版权图像内容，将 ``<image><path>`` 替换为先前添加的 ``.dds`` 文件的文件名。

## 编辑文件

### 编辑音乐分类

在``root\app\data\AXXX\music`` 目录中找到的 ``MusicSort.xml`` 文件列出了歌曲选择菜单中每首歌曲的顺序。该文件与歌曲所属的流派无关，但其格式仍考虑到了流派。要添加歌曲，只需创建一个新的 ``<StringID>`` 标记，其中的 ``<id>`` 和 ``<str>`` 标记将分别替换为歌曲的自定义 ID 和歌曲名称。